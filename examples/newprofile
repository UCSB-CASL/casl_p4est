#!/usr/bin/env bash

# Use this script to generate a pro file for an existing example
# 
# Usage:
#   ./newprofile name [config]
#

# creates a .pro file 
function create_pro() {
cat > $1.pro << EOF
CONFIG += 2d $2
include(../../config/libparcasl.pri)

CONFIG(2d, 2d|3d): {
  TARGET   = $1_2d
  SOURCES += main_2d.cpp
}

CONFIG(3d, 2d|3d): {
  TARGET   = $1_3d
  SOURCES += main_3d.cpp
}

EOF
}

if [[ "$#" -ne 1 ]]; then
    echo "useage: ./$(basename "$0") example [config]"
else
  name=$1
  config=$2

  # check if a config is set, if not set it to homebrew 
  if [[ -z $config ]]; then
    config="macx"
  fi

  # create a new example only if one does not exist with the same name
  if [[ -e $name ]]; then
    cd $name
    if [[ ! -e $name.pro ]]; then
      create_pro $name $config
    else
      echo "ERROR: Profile '$name.pro' already exists. Please choose another name."
      exit 1
    fi
  else
    echo "ERROR: Example '$name' does not exist. Please choose an existing example."
    exit 1
  fi  
fi
