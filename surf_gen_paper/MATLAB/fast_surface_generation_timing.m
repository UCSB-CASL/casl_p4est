clear all;


mpi_size=1;
lmin=[3, 4, 5, 6, 7];
lmax=[6, 7, 8, 7 , 10];
mols=['6rxn'; '1d65'; '2err'; '1aa2'; '2x6a'; '3M3D'; '1mah'; '1fss'; '1OED'; '3ecd'; '1JB0'; '3J6D'];
atoms=[667, 760, 1638, 1755, 4294, 8346, 9133, 9252, 10245, 23468, 34720, 131664];
  

times_slow = zeros(length(atoms), length(lmin));
times_fast = times_slow;

%%Data from surf_gen_results_2016-11-22-1747.txt
%{
times_slow(:,1)=[2.827873, 2.336673, 3.741220, 5.281586, 8.534796, 18.920009, 19.112484, 21.443307, 22.638735, 48.621821, 74.836180, 258.715781];
times_fast(:,1)=[1.283930, 0.898470, 0.786923, 1.226787, 0.797250, 1.026552, 0.895649, 1.087537, 0.998223, 0.963947, 1.023750, 0.899231];
nodes_slow(:,1)=[8014, 5231, 4344, 7865, 4396, 6236, 5267, 7001, 6435, 5693, 6384, 5089];
nodes_fast(:,1)=[8014, 5238, 4354, 7858, 4403, 6260, 5288, 7001, 6377, 5693, 6367, 5089];
times_slow(:,2)=[8.467015, 6.614341, 10.613178, 15.633441, 24.460322, 54.729789, 54.004517, 62.304218, 65.292138, 140.060311, 216.643813, 748.964054];
times_fast(:,2)=[3.978200, 2.404711, 2.039737, 3.748904, 1.981171, 2.987819, 2.417683, 3.205630, 2.922127, 2.661985, 2.973230, 2.428187];
nodes_slow(:,2)=[28868, 17486, 14660, 28503, 14174, 23407, 18260, 25303, 22557, 20202, 23438, 18358];
nodes_fast(:,2)=[28868, 17496, 14660, 28496, 14174, 23448, 18263, 25324, 22540, 20233, 23445, 18438];
times_slow(:,3)=[39.836352, 32.098830, 54.230530, 75.867975, 127.585563, 276.692163, 279.491852, 313.132778, 332.829223, 722.625097, 1105.606268, 3913.980572];
times_fast(:,3)=[18.063141, 10.325988, 8.676239, 17.095042, 8.319228, 13.208869, 10.494183, 14.232694, 12.804090, 11.478284, 13.268058, 10.548499];
nodes_slow(:,3)=[130397, 81678, 69529, 130616, 66481, 110777, 86987, 119625, 108326, 97442, 115259, 88942];
nodes_fast(:,3)=[130397, 81671, 69529, 130616, 66471, 110743, 86990, 119563, 108299, 97424, 115250, 88811];
times_slow(:,4)=[67.646407, 72.872180, 130.818642, 139.744965, 306.619344, 575.829381, 627.256701, 635.886074, 701.296132, 1574.925839, 2318.814667, 8728.671427];
times_fast(:,4)=[25.232329, 24.024238, 23.724812, 25.284779, 23.951399, 24.683372, 24.153308, 24.878087, 24.591127, 24.375809, 24.754612, 24.200781];
nodes_slow(:,4)=[292063, 283193, 281108, 291856, 280715, 287780, 283693, 289277, 286936, 285297, 287844, 283741];
nodes_fast(:,4)=[292063, 283210, 281108, 291856, 280715, 287821, 283700, 289305, 286936, 285328, 287844, 283849];
%}


mpi_size=1;
lmin=[3, 4, 5, 6, 7, 8];
lmax=[6, 7, 8, 9, 10, 11];

%%Data from surf_gen_results_2016-11-29-153855.txt
%mols=[6rx;, 1d65, 2err, 1aa2, 2x6a, 3M3D, 1mah, 1fss, 1OED, 3ecd, 1JB0, 3J6D];
atoms=[667, 760, 1638, 1755, 4294, 8346, 9133, 9252, 10245, 23468, 34720, 131664];
times_slow(:,1)=[2.833669, 2.366838, 3.761704, 5.308955, 8.586214, 18.975966, 19.179121, 21.563464, 22.732622, 48.829735, 75.202203, 260.094663];
times_fast(:,1)=[1.278030, 0.898020, 0.786301, 1.225619, 0.796467, 1.020091, 0.900622, 1.087291, 0.998220, 0.963475, 1.017188, 0.896598];
nodes_slow(:,1)=[8014, 5231, 4344, 7865, 4396, 6236, 5267, 7001, 6435, 5693, 6384, 5089];
nodes_fast(:,1)=[8014, 5238, 4354, 7858, 4403, 6260, 5288, 7001, 6377, 5693, 6367, 5089];
times_slow(:,2)=[8.499330, 6.642929, 10.649356, 15.708312, 24.562025, 54.963012, 54.210480, 62.555698, 65.609156, 140.840473, 217.896584, 753.084501];
times_fast(:,2)=[3.973730, 2.395658, 2.031652, 3.735871, 1.977377, 2.992361, 2.406132, 3.199861, 2.905931, 2.668557, 2.977674, 2.424644];
nodes_slow(:,2)=[28868, 17486, 14660, 28503, 14174, 23407, 18260, 25303, 22557, 20202, 23438, 18358];
nodes_fast(:,2)=[28868, 17496, 14660, 28496, 14174, 23448, 18263, 25324, 22540, 20233, 23445, 18438];
times_slow(:,3)=[40.022113, 32.304779, 54.555553, 76.314560, 128.205773, 278.096850, 280.898581, 314.604994, 334.710690, 726.772476, 1111.707960, 3935.491625];
times_fast(:,3)=[18.080380, 10.330627, 8.691189, 17.087113, 8.307181, 13.233819, 10.461306, 14.197465, 12.805050, 11.485080, 13.254993, 10.555626];
nodes_slow(:,3)=[130397, 81678, 69529, 130616, 66481, 110777, 86987, 119625, 108326, 97442, 115259, 88942];
nodes_fast(:,3)=[130397, 81671, 69529, 130616, 66471, 110743, 86990, 119563, 108299, 97424, 115250, 88811];
times_slow(:,4)=[240.600030, 211.764278, 375.347854, 493.624169, 896.330862, 1870.908073, 1937.503022, 2103.756001, 2259.478306, 4970.112951, 7532.642329, 27153.537392];
times_fast(:,4)=[95.213730, 60.162970, 52.010205, 98.500259, 49.071009, 77.628258, 61.628020, 83.278714, 74.007474, 66.488765, 77.549039, 61.204557];
nodes_slow(:,4)=[681482, 468374, 411117, 687928, 398188, 607479, 498071, 647801, 633357, 558780, 681608, 529983];
nodes_fast(:,4)=[681482, 468374, 411117, 687928, 398144, 607479, 498057, 647770, 633357, 558766, 681525, 529881];

     
times_msms = [0.07, 0.07 0.10, 0.10, 0.28, 0.38, 0.83, 0.41, 1.95, 2.89, 5.70, 29.74];  

speedup = times_slow./times_fast;

%% plot!
%{
figure(1);
plot(atoms, speedup(:,1),'b-x'); hold on;
plot(atoms, speedup(:,2),'r-o');
plot(atoms, speedup(:,3),'g-s'); hold off
xlabel('Number of atoms');
ylabel('Surface generation speedup factor');
legend('level 3,7', 'level 3,8', 'level 3,9');


figure(2)

plot(atoms, times_slow(:,1), 'b-x'); hold on;
plot(atoms, times_slow(:,2), 'r-o');
plot(atoms, times_slow(:,3), 'g-s'); hold off;

figure(3);
plot(atoms, times_slow(:,1), 'b-x'); hold on;
plot(atoms, times_slow(:,2), 'r-o');
plot(atoms, times_slow(:,3), 'g-s'); hold off;

%}
figure(4)
loglog(atoms, times_slow(:,1),'b-'); hold on;
loglog(atoms, times_slow(:,2),'b-.');
loglog(atoms, times_slow(:,3),'b--');

loglog(atoms, times_fast(:,1),'r-'); 
loglog(atoms, times_fast(:,2),'r-.');
loglog(atoms, times_fast(:,3),'r--');

%loglog(atoms, times_msms,'k-'); 


hold off;
legend('brute force 3,6', 'brute force 4,7', 'brute force 5,8', 'fast 3,6', 'fast 4,7', 'fast 5,8');
xlabel('number of atoms');
ylabel('time (s)');
fixfig();





